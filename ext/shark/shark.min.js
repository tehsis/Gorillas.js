var Base=function(){};Base.extend=function(_instance,_static){var extend=Base.prototype.extend;Base._prototyping=true;var proto=new this;extend.call(proto,_instance);proto.base=function(){};delete Base._prototyping;var constructor=proto.constructor;var klass=proto.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==klass){this._constructing=true;constructor.apply(this,arguments);delete this._constructing}else if(arguments[0]!=null){return(arguments[0].extend||extend).call(arguments[0],proto)}}};klass.ancestor=this;klass.extend=this.extend;klass.forEach=this.forEach;klass.implement=this.implement;klass.prototype=proto;klass.toString=this.toString;klass.valueOf=function(type){return type=="object"?klass:constructor.valueOf()};extend.call(klass,_static);if(typeof klass.init=="function")klass.init();return klass};Base.prototype={extend:function(source,value){if(arguments.length>1){var ancestor=this[source];if(ancestor&&typeof value=="function"&&(!ancestor.valueOf||ancestor.valueOf()!=value.valueOf())&&/\bbase\b/.test(value)){var method=value.valueOf();value=function(){var previous=this.base||Base.prototype.base;this.base=ancestor;var returnValue=method.apply(this,arguments);this.base=previous;return returnValue};value.valueOf=function(type){return type=="object"?value:method};value.toString=Base.toString}this[source]=value}else if(source){var extend=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){extend=this.extend||extend}var proto={toSource:null};var hidden=["constructor","toString","valueOf"];var i=Base._prototyping?0:1;while(key=hidden[i++]){if(source[key]!=proto[key]){extend.call(this,key,source[key])}}for(var key in source){if(!proto[key])extend.call(this,key,source[key])}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(object,block,context){for(var key in object){if(this.prototype[key]===undefined){block.call(context,object[key],key,object)}}},implement:function(){for(var i=0;i<arguments.length;i++){if(typeof arguments[i]==="function"){arguments[i](this.prototype)}else{this.prototype.extend(arguments[i])}}return this},toString:function(){return String(this.valueOf())}});(function(){window.Shark=window.Shark||{}})();(function(window,undefined){var Canvas=window.Base.extend({constructor:function(classText,width,height,parent){this.elem=document.createElement("canvas");this.elem.class=classText;this.elem.innerHTML="Shark needs a browser with HTML5 support.";this.elem.width=width;this.elem.height=height;this.elem.style.position="absolute";this.ctx=this.elem.getContext("2d");this.parent=parent;this.parentElement=document.getElementById(parent);this.bufferCanvas=this.elem.cloneNode();this.parentElement.appendChild(this.elem);this.bufferCtx=this.bufferCanvas.getContext("2d");return this.elem},parent:function(){return this.parent},element:function(){return this.elem},context:function(){return this.ctx},clear:function(){this.ctx.clearRect(0,0,this.elem.width,this.elem.height);this.bufferCtx.clearRect(0,0,this.elem.width,this.elem.height)}});var Vm=window.Base.extend({constructor:function(parent,width,height,clock){this.entities={};this.init=[];this.phases={};this.variables={};this.clock=clock;this.ticks=0;this.mainCanvas={className:"shark-main",width:width,height:height,parent:parent}},clearScreen:function(){var i;for(var entity in this.entities){this.entities[entity].clear()}},addPhase:function(name,f,isDefault){this.phases[name]=f;if(isDefault){this.actualPhase=name}},reset:function(){this.clearScreen();this.variables={}},phase:function(){var executingPhase=this.phases[this.actualPhase];var next=executingPhase();this.actualPhase=next},set:function(name,value){this.variables[name]=value},get:function(name,defaultValue){value=this.variables[name]||defaultValue;this.variables[name]=value;return value},del:function(name){this.variables[name]=undefined},onLoop:function(f){this.loop=f},onInit:function(f){this.init=f},addEntity:function(name,entity){entity.onAttach(this.mainCanvas);this.entities[name]=entity},entity:function(name){return this.entities[name]},getTicks:function(){return this.ticks},start:function(){this.init();var that=this;function looping(){that.loop();that.ticks++;window.requestAnimationFrame(looping)}window.requestAnimationFrame(looping)}});var Entity=window.Base.extend({constructor:function(x,y,width,height){this.position={};this.size={};this.position.x=x;this.position.y=y;this.size.width=width;this.size.height=height;this.update=true},x:function(x){this.position.x=x||this.position.x;return this.position.x},y:function(y){this.position.y=y||this.position.y;return this.position.y},width:function(width){this.size.width=width||this.position.width;return this.size.width},height:function(height){this.size.height=height||this.position.height;return this.size.height},show:function(){},onAttach:function(backCanvas){this.canvas=new Canvas("entity",backCanvas.width,backCanvas.height,backCanvas.parent)},hasCollisionedWith:function(entity){return this.x()+this.width()>=entity.x()&&this.x()<=entity.x()+entity.width()&&this.y()+this.height()>=entity.y()&&this.y()<=entity.y()+entity.height()},contex:function(){return this.canvas.context()},clear:function(){this.canvas.clear()}});var Core={Name:"Shark",Entity:Entity,App:Vm};window.Shark=window.Shark||{};window.Shark.Core=Core})(window,undefined);(function(window){var DSprite=window.Shark.Core.Entity.extend({constructor:function(x,y,width,height,baseF){this.base(x,y,width,height);this.addFunction(baseF);this.frame=0},draw:function(update,time){this.update=update||this.update;if(this.update){this.canvas.clear();var context=this.canvas.bufferCtx;context.save();context.translate(this.position.x,this.position.y);this.drawingFunctions[this.frame](context,time);context.restore();this.frame=this.drawingFunctions.length-1<this.frame?this.frame+1:0;this.canvas.context().drawImage(this.canvas.bufferCanvas,0,0);this.update=false}},addFunction:function(f){this.drawingFunctions=this.drawingFunctions||[];console.log(f.arguments);this.drawingFunctions.push(f)}});var Assets={Name:"Assets",Image:Image,DSprite:DSprite};window.Shark.Assets=Assets})(window);(function(window,undefined){var Shark=window.Shark||{};var Vm=Shark.Core.App.extend({constructor:function(parent,width,height,clock){this.base(parent,width,height,clock);this.eventQueue=[];this.listeningEvents=[];this.onListening=function(evt){var nevent={};switch(evt.type){case"keydown":switch(true){case evt.which===13:nevent.type="key";nevent.value="enter";break;case evt.which>=48&&evt.which<=57:nevent.type="numericKey";nevent.value=String.fromCharCode(evt.which);break;case evt.which>=65&&evt.which<=90||evt.which>=97&&evt.which<=122:nevent.type="alphaKey";nevent.value=String.fromCharCode(evt.which);break;default:nevent.type="unknow";nevent.value=evt.which}}this.eventQueue.push(nevent)}},listenEvent:function(event){if(this.listeningEvents.indexOf(event)===-1){this.listeningEvents.push(event);document.addEventListener(event,this.onListening.bind(this),false)}},flushEvents:function(){this.eventQueue=[]},stopListening:function(){this.listeningEvents=[]},getEvent:function(){var lastEvent=this.eventQueue.shift();return lastEvent}});window.Shark.Core.App=Vm})(window,undefined);(function(window,undefined){var Shark=window.Shark;var Text=Shark.Core.Entity.extend({constructor:function(text,x,y,font){this.base(x,y);text.font="50pt Arial";this.text=text},setText:function(ntext){this.text=ntext||this.text;return this.text},append:function(ntext){this.text+=ntext;return this.text},draw:function(update){this.update=update||this.update;if(this.update){this.canvas.clear();this.canvas.context().strokeText(this.text,this.position.x,this.position.y)}}});var Texts={name:"Texts",Text:Text};Shark.Texts=Texts})(window,undefined);